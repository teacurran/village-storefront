/**
 * Internationalization Composable
 *
 * Simple i18n wrapper for admin SPA. In production, replace with vue-i18n.
 * Supports en/es locales per Architecture Section 3.8.
 */

import { ref, computed } from 'vue'

const currentLocale = ref<'en' | 'es'>('en')

// Mock translations - replace with actual locale files
const translations: Record<string, Record<string, string>> = {
  en: {
    'common.loading': 'Loading...',
    'common.refresh': 'Refresh',
    'common.retry': 'Retry',
    'common.export': 'Export',
    'common.close': 'Close',
    'common.cancel': 'Cancel',
    'common.confirm': 'Confirm',
    'common.view': 'View',
    'common.loadMore': 'Load More',
    'common.live': 'Live',
    'common.offline': 'Offline',
    'orders.dashboard.title': 'Orders',
    'orders.dashboard.subtitle': 'Manage customer orders and fulfillment',
    'orders.stats.totalOrders': 'Total Orders',
    'orders.stats.pendingOrders': 'Pending Orders',
    'orders.stats.revenue': 'Revenue',
    'orders.stats.avgOrderValue': 'Avg Order Value',
    'orders.search.placeholder': 'Search orders...',
    'orders.filters.allStatuses': 'All Statuses',
    'orders.filters.clear': 'Clear Filters',
    'orders.status.pending': 'Pending',
    'orders.status.confirmed': 'Confirmed',
    'orders.status.processing': 'Processing',
    'orders.status.shipped': 'Shipped',
    'orders.status.delivered': 'Delivered',
    'orders.status.cancelled': 'Cancelled',
    'orders.status.refunded': 'Refunded',
    'orders.table.orderNumber': 'Order #',
    'orders.table.customer': 'Customer',
    'orders.table.status': 'Status',
    'orders.table.total': 'Total',
    'orders.table.date': 'Date',
    'orders.table.actions': 'Actions',
    'orders.bulkActions.selectedCount': '{count} orders selected',
    'orders.bulkActions.updateStatus': 'Update Status',
    'orders.bulkActions.updateDescription': 'Update status for {count} orders',
    'orders.actions.export': 'Export Orders',
    'orders.actions.markProcessing': 'Mark Processing',
    'orders.actions.markShipped': 'Mark Shipped',
    'orders.actions.markDelivered': 'Mark Delivered',
    'orders.actions.cancelOrder': 'Cancel Order',
    'orders.actions.defaultCancelReason': 'Cancelled via admin dashboard',
    'orders.detailDrawer.orderLabel': 'Order',
    'orders.detailDrawer.empty': 'Select an order to view details',
    'orders.detailDrawer.status': 'Status',
    'orders.detailDrawer.total': 'Order Total',
    'orders.detailDrawer.paymentMethod': 'Payment Method',
    'orders.detailDrawer.lineItems': 'Line Items',
    'orders.detailDrawer.timeline': 'Timeline',
    'orders.detailDrawer.systemActor': 'System',
    'orders.detailDrawer.actions': 'Actions',
    'orders.errors.loadFailed': 'Failed to load orders',
    'orders.errors.unauthorized': 'You do not have permission to view orders',
    'orders.errors.featureDisabled': 'Orders feature is not enabled',
    'orders.errors.exportFailed': 'Failed to export orders',
    'orders.errors.bulkUpdateFailed': 'Failed to update orders',
    'orders.errors.detailFailed': 'Failed to load order detail',
    'orders.errors.cancelFailed': 'Failed to cancel order',
    'orders.messages.refreshed': 'Orders refreshed',
    'orders.messages.filtersCleared': 'Filters cleared',
    'orders.messages.exported': 'Orders exported successfully',
    'orders.messages.bulkUpdateSuccess': 'Orders updated successfully',
    'inventory.title': 'Inventory Management',
    'inventory.subtitle': 'Monitor stock across locations with live alerts',
    'inventory.upgradeTitle': 'Inventory Disabled',
    'inventory.upgradeCopy': 'Enable inventory features for this tenant to access the dashboard.',
    'inventory.filters.location': 'Location',
    'inventory.filters.search': 'Search SKU or product',
    'inventory.filters.lowStockOnly': 'Low stock only',
    'inventory.metrics.totalSkus': 'Tracked SKUs',
    'inventory.metrics.lowStock': 'Low stock',
    'inventory.table.sku': 'SKU',
    'inventory.table.product': 'Product',
    'inventory.table.available': 'Available',
    'inventory.table.reserved': 'Reserved',
    'inventory.table.onHand': 'On Hand',
    'inventory.table.daysInStock': 'Days in Stock',
    'inventory.detailDrawer.subtitle': 'Inventory Detail',
    'inventory.detailDrawer.empty': 'Select an item to view details.',
    'inventory.detailDrawer.location': 'Location',
    'inventory.detailDrawer.lastUpdated': 'Last updated',
    'inventory.detailDrawer.transfers': 'Recent Transfers',
    'inventory.detailDrawer.noTransfers': 'No transfers recorded for this SKU.',
    'inventory.detailDrawer.actions': 'Inline Actions',
    'inventory.detailDrawer.adjust': 'Record Adjustment',
    'inventory.emptyState': 'No inventory records found.',
    'inventory.messages.refreshed': 'Inventory refreshed',
    'inventory.messages.adjusted': 'Adjustment recorded',
    'inventory.errors.loadFailed': 'Failed to load inventory data',
    'inventory.errors.adjustFailed': 'Failed to record adjustment',
    'inventory.adjustDialog.title': 'Record Adjustment',
    'inventory.adjustDialog.quantity': 'Quantity Change',
    'inventory.adjustDialog.reason': 'Reason',
    'inventory.adjustDialog.notes': 'Notes (optional)',
    'inventory.adjustDialog.save': 'Save Adjustment',
    'inventory.adjustDialog.reasons.damage': 'Damaged',
    'inventory.adjustDialog.reasons.cycleCount': 'Cycle Count',
    'inventory.adjustDialog.reasons.returned': 'Customer Return',
    'reporting.title': 'Reports & Analytics',
    'reporting.subtitle': 'Track KPIs, slow movers, and export data sets',
    'reporting.actions.export': 'Export Report',
    'reporting.filters.startDate': 'Start Date',
    'reporting.filters.endDate': 'End Date',
    'reporting.metrics.revenue': 'Total Revenue',
    'reporting.metrics.orders': 'Orders',
    'reporting.metrics.avgOrderValue': 'Avg Order Value',
    'reporting.slowMovers.title': 'Slow Movers',
    'reporting.slowMovers.subtitle': 'Items aging in inventory',
    'reporting.table.sku': 'SKU',
    'reporting.table.location': 'Location',
    'reporting.table.quantity': 'Qty',
    'reporting.table.daysInStock': 'Days',
    'reporting.exports.title': 'Exports',
    'reporting.exports.subtitle': 'Scheduled and completed jobs',
    'reporting.exports.empty': 'No export jobs yet.',
    'reporting.actions.download': 'Download',
    'reporting.errors.loadFailed': 'Failed to load reporting data',
    'reporting.errors.exportFailed': 'Unable to start export',
    'reporting.messages.exportRequested': 'Export requested',
    'loyalty.title': 'Loyalty Programs',
    'loyalty.subtitle': 'Manage tiers, balances, and adjustments',
    'loyalty.featureDisabledTitle': 'Loyalty Disabled',
    'loyalty.featureDisabledCopy': 'Enable loyalty for this tenant to configure programs.',
    'loyalty.program.pointsPerDollar': 'Points per Dollar',
    'loyalty.program.redemptionValue': 'Redemption Value',
    'loyalty.program.expiration': 'Expiration (days)',
    'loyalty.tiers.title': 'Tier Structure',
    'loyalty.tiers.subtitle': 'Define progression for customers',
    'loyalty.members.title': 'Member Lookup',
    'loyalty.members.subtitle': 'Search by user ID to view balances',
    'loyalty.members.lookupPlaceholder': 'Enter user UUID (e.g. 123e4567-e89b-12d3-a456-426614174000)',
    'loyalty.members.lookup': 'Lookup Member',
    'loyalty.members.pointsBalance': 'Points Balance',
    'loyalty.members.tier': 'Current Tier',
    'loyalty.table.tier': 'Tier',
    'loyalty.table.minPoints': 'Min Points',
    'loyalty.table.multiplier': 'Multiplier',
    'loyalty.table.date': 'Date',
    'loyalty.table.reason': 'Reason',
    'loyalty.table.points': 'Points',
    'loyalty.table.balanceAfter': 'Balance After',
    'loyalty.actions.adjustPoints': 'Adjust Points',
    'loyalty.adjust.points': 'Points Delta',
    'loyalty.adjust.reason': 'Reason',
    'loyalty.adjust.reasonBonus': 'Bonus',
    'loyalty.adjust.reasonCorrection': 'Correction',
    'loyalty.adjust.reasonAppeasement': 'Appeasement',
    'loyalty.errors.loadFailed': 'Failed to load loyalty program',
    'loyalty.errors.lookupFailed': 'Unable to find member',
    'loyalty.errors.adjustFailed': 'Adjustment failed',
    'loyalty.messages.adjusted': 'Points adjusted',
    'notifications.title': 'Notifications',
    'notifications.subtitle': 'Live alerts from background jobs and services',
    'notifications.actions.markAll': 'Mark all read',
    'notifications.actions.markRead': 'Mark read',
    'notifications.actions.open': 'Open',
    'notifications.filters.search': 'Search notifications',
    'notifications.filters.all': 'All severities',
    'notifications.filters.error': 'Errors',
    'notifications.filters.warning': 'Warnings',
    'notifications.filters.success': 'Success',
    'notifications.filters.info': 'Info',
    'notifications.severity.info': 'Info',
    'notifications.severity.success': 'Success',
    'notifications.severity.warning': 'Warning',
    'notifications.severity.error': 'Error',
    'notifications.emptyState': 'No notifications to display.',
    'orders.messages.statusUpdated': 'Order status updated',
    'orders.messages.orderCancelled': 'Order cancelled',
  },
  es: {
    'common.loading': 'Cargando...',
    'common.refresh': 'Actualizar',
    'common.retry': 'Reintentar',
    'common.export': 'Exportar',
    'common.close': 'Cerrar',
    'common.cancel': 'Cancelar',
    'common.confirm': 'Confirmar',
    'common.view': 'Ver',
    'common.loadMore': 'Cargar Más',
    'common.live': 'En Vivo',
    'common.offline': 'Desconectado',
    'orders.dashboard.title': 'Pedidos',
    'orders.dashboard.subtitle': 'Gestionar pedidos de clientes y cumplimiento',
    'inventory.title': 'Gestión de inventario',
    'inventory.subtitle': 'Supervise existencias en todas las ubicaciones',
    'reporting.title': 'Reportes y analítica',
    'reporting.subtitle': 'Seguimiento de KPIs y exportaciones',
    'loyalty.title': 'Programas de lealtad',
    'loyalty.subtitle': 'Gestione niveles y puntos',
    'notifications.title': 'Notificaciones',
    'notifications.subtitle': 'Alertas en tiempo real',
  },
}

export function useI18n() {
  const t = (key: string, params?: Record<string, any>): string => {
    let text = translations[currentLocale.value]?.[key] || key

    if (params) {
      Object.entries(params).forEach(([param, value]) => {
        text = text.replace(`{${param}}`, String(value))
      })
    }

    return text
  }

  const formatCurrency = (money: { amount: number; currency: string }): string => {
    return new Intl.NumberFormat(currentLocale.value, {
      style: 'currency',
      currency: money.currency,
    }).format(money.amount / 100)
  }

  const setLocale = (locale: 'en' | 'es') => {
    currentLocale.value = locale
  }

  return {
    t,
    formatCurrency,
    setLocale,
    locale: computed(() => currentLocale.value),
  }
}
